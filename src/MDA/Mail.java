package MDA;

import javax.mail.Multipart;
import javax.mail.BodyPart;
import javax.mail.internet.MimeMultipart;
import javax.activation.DataSource;
import javax.activation.DataHandler;
import javax.activation.FileDataSource;
import javax.swing.JFileChooser;
import javax.mail.internet.MimeBodyPart;
import javax.mail.Authenticator;
import javax.mail.Transport;
import javax.mail.MessagingException;
import javax.mail.internet.AddressException;
import java.util.logging.Level;
import java.util.logging.Logger;
import java.security.Principal;
import javax.swing.JOptionPane;
import javax.mail.Message;
import javax.mail.Address;
import javax.mail.internet.InternetAddress;
import javax.mail.internet.MimeMessage;
import javax.mail.Session;
import java.util.Properties;
import objeto.Cargador;

public class Mail
{
    public String template;
    String mensaje;
    
    public void sendMail(Cargador objCargador) {
        Properties propiedad = new Properties();
        propiedad.setProperty("mail.smtp.host", "mail.colemed.com");
        propiedad.setProperty("mail.smtp.starttls.enable", "false");
        propiedad.setProperty("mail.smtp.port", "587");
        propiedad.setProperty("mail.smtp.auth", "true");
        Session sesion = Session.getDefaultInstance(propiedad);
        String correoEnvia = "claves@colemed.com";
        String contrasena = "Lamadrid51";
        String destinatario = "" + objCargador.mail + "";
        String asunto = "Información Importante Dpto. Prestacional CMT";
        String mensaje = "Dr/a. " + objCargador.nombre.trim() + " \n\nSu Clave para el Sistema de Colegio Médico es: " + objCargador.claveGestion.trim() + "\n\nPara acceder al sistema ingrese en: http://www.colemed.com/ - Autorizar Otras Obras Sociales\n\nColegio Médico de Tucumán";
        MimeMessage mail = new MimeMessage(sesion);
        try {
            mail.setFrom((Address)new InternetAddress(correoEnvia));
            mail.addRecipient(Message.RecipientType.TO, (Address)new InternetAddress(destinatario));
            mail.setSubject(asunto);
            mail.setText(mensaje);
            Transport transporte = sesion.getTransport("smtp");
            transporte.connect(correoEnvia, contrasena);
            transporte.sendMessage((Message)mail, mail.getRecipients(Message.RecipientType.TO));
            transporte.close();
            JOptionPane.showMessageDialog(null, "Correo enviado");
        }
        catch (AddressException ex) {
            Logger.getLogger(Principal.class.getName()).log(Level.SEVERE, null, (Throwable)ex);
        }
        catch (MessagingException ex2) {
            Logger.getLogger(Principal.class.getName()).log(Level.SEVERE, null, (Throwable)ex2);
        }
    }
    
    public void sendMailDesbloqueado(Cargador objCargador) {
        Properties propiedad = new Properties();
        propiedad.setProperty("mail.smtp.host", "mail.colemed.com");
        propiedad.setProperty("mail.smtp.starttls.enable", "false");
        propiedad.setProperty("mail.smtp.port", "587");
        propiedad.setProperty("mail.smtp.auth", "true");
        Session sesion = Session.getDefaultInstance(propiedad);
        String correoEnvia = "claves@colemed.com";
        String contrasena = "Lamadrid51";
        String destinatario = "" + objCargador.mail + "";
        String asunto = "Información Importante Dpto. Prestacional CMT";
        String mensaje = "Dr/a. " + objCargador.nombre.trim() + " \n\nSu Clave para Autorizar Otras O.S. es: " + objCargador.claveGestion.trim() + "\n\nPara acceder al sistema ingrese en: http://www.colemed.com/ \n\nColegio Médico de Tucumán";
        MimeMessage mail = new MimeMessage(sesion);
        try {
            mail.setFrom((Address)new InternetAddress(correoEnvia));
            mail.addRecipient(Message.RecipientType.TO, (Address)new InternetAddress(destinatario));
            mail.setSubject(asunto);
            mail.setText(mensaje);
            Transport transporte = sesion.getTransport("smtp");
            transporte.connect(correoEnvia, contrasena);
            transporte.sendMessage((Message)mail, mail.getRecipients(Message.RecipientType.TO));
            transporte.close();
            JOptionPane.showMessageDialog(null, "Correo enviado");
        }
        catch (AddressException ex) {
            Logger.getLogger(Principal.class.getName()).log(Level.SEVERE, null, (Throwable)ex);
        }
        catch (MessagingException ex2) {
            Logger.getLogger(Principal.class.getName()).log(Level.SEVERE, null, (Throwable)ex2);
        }
    }
    
    public void sendMailCMT(Cargador objCargador) {
        String template = "<!DOCTYPE html PUBLIC \"-//W3C//DTD XHTML 1.0 Transitional//EN\" \"http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd\">\n<html xmlns=\"http://www.w3.org/1999/xhtml\" xmlns:o=\"urn:schemas-microsoft-com:office:office\">\n\n<head>\n    <meta charset=\"UTF-8\">\n    <meta content=\"width=device-width, initial-scale=1\" name=\"viewport\">\n    <meta name=\"x-apple-disable-message-reformatting\">\n    <meta http-equiv=\"X-UA-Compatible\" content=\"IE=edge\">\n    <meta content=\"telephone=no\" name=\"format-detection\">\n    <title></title>\n    <!--[if (mso 16)]>\n    <style type=\"text/css\">\n    a {text-decoration: none;}\n    </style>\n    <![endif]-->\n    <!--[if gte mso 9]><style>sup { font-size: 100% !important; }</style><![endif]-->\n    <!--[if gte mso 9]>\n<xml>\n    <o:OfficeDocumentSettings>\n    <o:AllowPNG></o:AllowPNG>\n    <o:PixelsPerInch>96</o:PixelsPerInch>\n    </o:OfficeDocumentSettings>\n</xml>\n<![endif]-->\n</head>\n\n<body>\n    <div class=\"es-wrapper-color\">\n        <!--[if gte mso 9]>\n\t\t\t<v:background xmlns:v=\"urn:schemas-microsoft-com:vml\" fill=\"t\">\n\t\t\t\t<v:fill type=\"tile\" color=\"#f8f9fd\"></v:fill>\n\t\t\t</v:background>\n\t\t<![endif]-->\n        <table class=\"es-wrapper\" width=\"100%\" cellspacing=\"0\" cellpadding=\"0\">\n            <tbody>\n                <tr>\n                    <td class=\"esd-email-paddings\" valign=\"top\">\n                        <table class=\"es-content esd-header-popover\" cellspacing=\"0\" cellpadding=\"0\" align=\"center\">\n                            <tbody>\n                                <tr>\n                                    <td class=\"esd-stripe\" style=\"background-color: #293243; background-image: url(https://uxyja.stripocdn.email/content/guids/CABINET_1ce849b9d6fc2f13978e163ad3c663df/images/33971592408649468.png); background-repeat: no-repeat; background-position: center center;\" bgcolor=\"#293243\" background=\"https://uxyja.stripocdn.email/content/guids/CABINET_1ce849b9d6fc2f13978e163ad3c663df/images/33971592408649468.png\" align=\"center\">\n                                        <table class=\"es-content-body\" width=\"600\" cellspacing=\"0\" cellpadding=\"0\" bgcolor=\"#ffffff\" align=\"center\">\n                                            <tbody>\n                                                <tr>\n                                                    <td class=\"esd-structure es-p20t es-p20r es-p20l\" align=\"left\">\n                                                        <table width=\"100%\" cellspacing=\"0\" cellpadding=\"0\">\n                                                            <tbody>\n                                                                <tr>\n                                                                    <td class=\"esd-container-frame\" esd-custom-block-id=\"232378\" width=\"560\" valign=\"top\" align=\"center\">\n                                                                        <table width=\"100%\" cellspacing=\"0\" cellpadding=\"0\">\n                                                                            <tbody>\n                                                                                <tr>\n                                                                                    <td class=\"esd-block-image\" style=\"font-size: 0px;\" align=\"center\"><a target=\"_blank\" href=\"https://www.colemed.com/mesa.html\"><img class=\"adapt-img\" src=\"https://colemed.com/mailmasivo/bannerMDAhmtl.png\" alt style=\"display: block;\" width=\"560\"></a></td>\n                                                                                </tr>\n                                                                            </tbody>\n                                                                        </table>\n                                                                    </td>\n                                                                </tr>\n                                                            </tbody>\n                                                        </table>\n                                                    </td>\n                                                </tr>\n                                            </tbody>\n                                        </table>\n                                    </td>\n                                </tr>\n                            </tbody>\n                        </table>\n                        <table class=\"es-content\" cellspacing=\"0\" cellpadding=\"0\" align=\"center\">\n                            <tbody>\n                                <tr>\n                                    <td class=\"esd-stripe\" align=\"center\">\n                                        <table class=\"es-content-body\" style=\"border-left:10px solid transparent;border-right:10px solid transparent;border-top:10px solid transparent;border-bottom:10px solid transparent;\" width=\"600\" cellspacing=\"0\" cellpadding=\"0\" bgcolor=\"#ffffff\" align=\"center\">\n                                            <tbody>\n                                                <tr>\n                                                    <td class=\"es-p20t es-p20r es-p20l esd-structure\" align=\"left\">\n                                                        <table width=\"100%\" cellspacing=\"0\" cellpadding=\"0\">\n                                                            <tbody>\n                                                                <tr>\n                                                                    <td class=\"esd-container-frame\" width=\"540\" valign=\"top\" align=\"center\">\n                                                                        <table width=\"100%\" cellspacing=\"0\" cellpadding=\"0\">\n                                                                            <tbody>\n                                                                                <tr>\n                                                                                    <td class=\"esd-block-text\" align=\"center\">\n                                                                                        <p style=\"font-size: 20px;\"><br><strong>Sr/a. " + objCargador.nombre + "</strong><br>Su Usuario para el Sistema de Colegio M\u00e9dico es:<br><strong>" + objCargador.codme + "</strong><br>Su Clave es:<br><strong>" + objCargador.claveGestion + "</strong><br><br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; Para acceder al sistema ingrese en: <a target=\"_blank\" href=\"http://www.colegiomedicotucuman.com.ar/\" style=\"font-size: 20px;\">http://www.colegiomedicotucuman.com.ar/</a> - Autogesti\u00f3n >> Ingreso CMT.<br><br><strong><em>Colegio M\u00e9dico de Tucum\u00e1n</em></strong><br><br></p>\n                                                                                    </td>\n                                                                                </tr>\n                                                                            </tbody>\n                                                                        </table>\n                                                                    </td>\n                                                                </tr>\n                                                            </tbody>\n                                                        </table>\n                                                    </td>\n                                                </tr>\n                                            </tbody>\n                                        </table>\n                                    </td>\n                                </tr>\n                            </tbody>\n                        </table>\n                        <table class=\"es-content esd-footer-popover\" cellspacing=\"0\" cellpadding=\"0\" align=\"center\">\n                            <tbody>\n                                <tr>\n                                    <td class=\"esd-stripe\" style=\"background-color: #293243;\" bgcolor=\"#293243\" align=\"center\">\n                                        <table class=\"es-content-body\" width=\"600\" cellspacing=\"0\" cellpadding=\"0\" bgcolor=\"#ffffff\" align=\"center\">\n                                            <tbody>\n                                                <tr>\n                                                    <td class=\"es-p20t es-p20r es-p20l esd-structure\" align=\"left\">\n                                                        <table width=\"100%\" cellspacing=\"0\" cellpadding=\"0\">\n                                                            <tbody>\n                                                                <tr>\n                                                                    <td class=\"esd-container-frame\" width=\"560\" valign=\"top\" align=\"center\">\n                                                                        <table width=\"100%\" cellspacing=\"0\" cellpadding=\"0\">\n                                                                            <tbody>\n                                                                                <tr>\n                                                                                    <td class=\"esd-block-image\" style=\"font-size: 0px;\" align=\"center\"><a target=\"_blank\"><img class=\"adapt-img\" src=\"https://colemed.com/mailmasivo/contactoMDAhtml.png\" alt style=\"display: block;\" width=\"560\"></a></td>\n                                                                                </tr>\n                                                                            </tbody>\n                                                                        </table>\n                                                                    </td>\n                                                                </tr>\n                                                            </tbody>\n                                                        </table>\n                                                    </td>\n                                                </tr>\n                                            </tbody>\n                                        </table>\n                                    </td>\n                                </tr>\n                            </tbody>\n                        </table>\n                    </td>\n                </tr>\n            </tbody>\n        </table>\n    </div>\n</body>\n\n</html>";
        try {
            Properties propiedad = new Properties();
            propiedad.setProperty("mail.smtp.host", "mail.colemed.com");
            propiedad.setProperty("mail.smtp.starttls.enable", "false");
            propiedad.setProperty("mail.smtp.port", "587");
            propiedad.setProperty("mail.smtp.user", "claves@colemed.com");
            propiedad.setProperty("mail.smtp.auth", "true");
            Session session = Session.getDefaultInstance(propiedad, (Authenticator)null);
            session.setDebug(true);
            BodyPart adjunto = (BodyPart)new MimeBodyPart();
            adjunto.setDataHandler(new DataHandler((DataSource)new FileDataSource(new JFileChooser().getSelectedFile())));
            MimeMessage message = new MimeMessage(session);
            message.setFrom((Address)new InternetAddress("claves@colemed.com"));
            message.addRecipient(Message.RecipientType.TO, (Address)new InternetAddress(objCargador.mail)); //InternetAddress("mesadeayuda@colegiomedicotucuman.com.ar"));
            message.setSubject("Información Importante Dpto. Prestacional CMT");
            MimeMultipart content = new MimeMultipart();
            MimeBodyPart textPart = new MimeBodyPart();
            textPart.setText(template.replaceAll("#MENSAJE#", mensaje), "utf-8", "html");
            content.addBodyPart((BodyPart)textPart);
            message.setContent((Multipart)content);
            Transport t = session.getTransport("smtp");
            t.connect("claves@colemed.com", "Lamadrid51");
            t.sendMessage((Message)message, message.getAllRecipients());
            t.close();
            JOptionPane.showMessageDialog(null, "Mensaje Enviado.");
        }
        catch (Exception e) {
            JOptionPane.showMessageDialog(null, "Mensaje no Enviado.");
            e.printStackTrace();
        }
    }
    
    public void sendMailIPSST(Cargador objCargador) {
        String template = "<!DOCTYPE html PUBLIC \"-//W3C//DTD XHTML 1.0 Transitional//EN\" \"http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd\">\n<html xmlns=\"http://www.w3.org/1999/xhtml\" xmlns:o=\"urn:schemas-microsoft-com:office:office\">\n\n<head>\n    <meta charset=\"UTF-8\">\n    <meta content=\"width=device-width, initial-scale=1\" name=\"viewport\">\n    <meta name=\"x-apple-disable-message-reformatting\">\n    <meta http-equiv=\"X-UA-Compatible\" content=\"IE=edge\">\n    <meta content=\"telephone=no\" name=\"format-detection\">\n    <title></title>\n    <!--[if (mso 16)]>\n    <style type=\"text/css\">\n    a {text-decoration: none;}\n    </style>\n    <![endif]-->\n    <!--[if gte mso 9]><style>sup { font-size: 100% !important; }</style><![endif]-->\n    <!--[if gte mso 9]>\n<xml>\n    <o:OfficeDocumentSettings>\n    <o:AllowPNG></o:AllowPNG>\n    <o:PixelsPerInch>96</o:PixelsPerInch>\n    </o:OfficeDocumentSettings>\n</xml>\n<![endif]-->\n</head>\n\n<body>\n    <div class=\"es-wrapper-color\">\n        <!--[if gte mso 9]>\n\t\t\t<v:background xmlns:v=\"urn:schemas-microsoft-com:vml\" fill=\"t\">\n\t\t\t\t<v:fill type=\"tile\" color=\"#f8f9fd\"></v:fill>\n\t\t\t</v:background>\n\t\t<![endif]-->\n        <table class=\"es-wrapper\" width=\"100%\" cellspacing=\"0\" cellpadding=\"0\">\n            <tbody>\n                <tr>\n                    <td class=\"esd-email-paddings\" valign=\"top\">\n                        <table class=\"es-content esd-header-popover\" cellspacing=\"0\" cellpadding=\"0\" align=\"center\">\n                            <tbody>\n                                <tr>\n                                    <td class=\"esd-stripe\" style=\"background-color: #293243; background-image: url(https://uxyja.stripocdn.email/content/guids/CABINET_1ce849b9d6fc2f13978e163ad3c663df/images/33971592408649468.png); background-repeat: no-repeat; background-position: center center;\" bgcolor=\"#293243\" background=\"https://uxyja.stripocdn.email/content/guids/CABINET_1ce849b9d6fc2f13978e163ad3c663df/images/33971592408649468.png\" align=\"center\">\n                                        <table class=\"es-content-body\" width=\"600\" cellspacing=\"0\" cellpadding=\"0\" bgcolor=\"#ffffff\" align=\"center\">\n                                            <tbody>\n                                                <tr>\n                                                    <td class=\"esd-structure es-p20t es-p20r es-p20l\" align=\"left\">\n                                                        <table width=\"100%\" cellspacing=\"0\" cellpadding=\"0\">\n                                                            <tbody>\n                                                                <tr>\n                                                                    <td class=\"esd-container-frame\" esd-custom-block-id=\"232378\" width=\"560\" valign=\"top\" align=\"center\">\n                                                                        <table width=\"100%\" cellspacing=\"0\" cellpadding=\"0\">\n                                                                            <tbody>\n                                                                                <tr>\n                                                                                    <td class=\"esd-block-image\" style=\"font-size: 0px;\" align=\"center\"><a target=\"_blank\" href=\"https://www.colemed.com/mesa.html\"><img class=\"adapt-img\" src=\"https://colemed.com/mailmasivo/bannerMDAhmtl.png\" alt style=\"display: block;\" width=\"560\"></a></td>\n                                                                                </tr>\n                                                                            </tbody>\n                                                                        </table>\n                                                                    </td>\n                                                                </tr>\n                                                            </tbody>\n                                                        </table>\n                                                    </td>\n                                                </tr>\n                                            </tbody>\n                                        </table>\n                                    </td>\n                                </tr>\n                            </tbody>\n                        </table>\n                        <table class=\"es-content\" cellspacing=\"0\" cellpadding=\"0\" align=\"center\">\n                            <tbody>\n                                <tr>\n                                    <td class=\"esd-stripe\" align=\"center\">\n                                        <table class=\"es-content-body\" style=\"border-left:10px solid transparent;border-right:10px solid transparent;border-top:10px solid transparent;border-bottom:10px solid transparent;\" width=\"600\" cellspacing=\"0\" cellpadding=\"0\" bgcolor=\"#ffffff\" align=\"center\">\n                                            <tbody>\n                                                <tr>\n                                                    <td class=\"es-p20t es-p20r es-p20l esd-structure\" align=\"left\">\n                                                        <table width=\"100%\" cellspacing=\"0\" cellpadding=\"0\">\n                                                            <tbody>\n                                                                <tr>\n                                                                    <td class=\"esd-container-frame\" width=\"540\" valign=\"top\" align=\"center\">\n                                                                        <table width=\"100%\" cellspacing=\"0\" cellpadding=\"0\">\n                                                                            <tbody>\n                                                                                <tr>\n                                                                                    <td class=\"esd-block-text\" align=\"center\">\n                                                                                        <p style=\"font-size: 20px;\"><br><strong>Sr/a. " + objCargador.nombre + "</strong><br>Su Usuario para el Sistema de Subsidio de Salud es:<br><strong>" + objCargador.dni + "</strong><br>Su Clave es:<br><strong>" + objCargador.claveIpsst + "</strong><br><br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; Para acceder al sistema ingrese en: <a target=\"_blank\" href=\"https://colegiomedicotucuman.com.ar/\" style=\"font-size: 20px;\">https://colegiomedicotucuman.com.ar/</a> - Autogesti\u00f3n >> Ingreso IPSST.<br><br><strong><em>Colegio M\u00e9dico de Tucum\u00e1n</em></strong><br><br></p>\n                                                                                    </td>\n                                                                                </tr>\n                                                                            </tbody>\n                                                                        </table>\n                                                                    </td>\n                                                                </tr>\n                                                            </tbody>\n                                                        </table>\n                                                    </td>\n                                                </tr>\n                                            </tbody>\n                                        </table>\n                                    </td>\n                                </tr>\n                            </tbody>\n                        </table>\n                        <table class=\"es-content esd-footer-popover\" cellspacing=\"0\" cellpadding=\"0\" align=\"center\">\n                            <tbody>\n                                <tr>\n                                    <td class=\"esd-stripe\" style=\"background-color: #293243;\" bgcolor=\"#293243\" align=\"center\">\n                                        <table class=\"es-content-body\" width=\"600\" cellspacing=\"0\" cellpadding=\"0\" bgcolor=\"#ffffff\" align=\"center\">\n                                            <tbody>\n                                                <tr>\n                                                    <td class=\"es-p20t es-p20r es-p20l esd-structure\" align=\"left\">\n                                                        <table width=\"100%\" cellspacing=\"0\" cellpadding=\"0\">\n                                                            <tbody>\n                                                                <tr>\n                                                                    <td class=\"esd-container-frame\" width=\"560\" valign=\"top\" align=\"center\">\n                                                                        <table width=\"100%\" cellspacing=\"0\" cellpadding=\"0\">\n                                                                            <tbody>\n                                                                                <tr>\n                                                                                    <td class=\"esd-block-image\" style=\"font-size: 0px;\" align=\"center\"><a target=\"_blank\"><img class=\"adapt-img\" src=\"https://colemed.com/mailmasivo/contactoMDAhtml.png\" alt style=\"display: block;\" width=\"560\"></a></td>\n                                                                                </tr>\n                                                                            </tbody>\n                                                                        </table>\n                                                                    </td>\n                                                                </tr>\n                                                            </tbody>\n                                                        </table>\n                                                    </td>\n                                                </tr>\n                                            </tbody>\n                                        </table>\n                                    </td>\n                                </tr>\n                            </tbody>\n                        </table>\n                    </td>\n                </tr>\n            </tbody>\n        </table>\n    </div>\n</body>\n\n</html>";
        try {
            Properties propiedad = new Properties();
            propiedad.setProperty("mail.smtp.host", "mail.colemed.com");
            propiedad.setProperty("mail.smtp.starttls.enable", "false");
            propiedad.setProperty("mail.smtp.port", "587");
            propiedad.setProperty("mail.smtp.user", "claves@colemed.com");
            propiedad.setProperty("mail.smtp.auth", "true");
            Session session = Session.getDefaultInstance(propiedad, (Authenticator)null);
            session.setDebug(true);
            BodyPart adjunto = (BodyPart)new MimeBodyPart();
            adjunto.setDataHandler(new DataHandler((DataSource)new FileDataSource(new JFileChooser().getSelectedFile())));
            MimeMessage message = new MimeMessage(session);
            message.setFrom((Address)new InternetAddress("claves@colemed.com"));
            message.addRecipient(Message.RecipientType.TO, (Address)new InternetAddress(objCargador.mail));
            message.setSubject("Información Importante Dpto. Prestacional CMT");
            MimeMultipart content = new MimeMultipart();
            MimeBodyPart textPart = new MimeBodyPart();
            textPart.setText(template.replaceAll("#MENSAJE#", mensaje), "utf-8", "html");
            content.addBodyPart((BodyPart)textPart);
            message.setContent((Multipart)content);
            Transport t = session.getTransport("smtp");
            t.connect("claves@colemed.com", "Lamadrid51");
            t.sendMessage((Message)message, message.getAllRecipients());
            t.close();
            JOptionPane.showMessageDialog(null, "Mensaje Enviado.");
        }
        catch (Exception e) {
            JOptionPane.showMessageDialog(null, "Mensaje no Enviado.");
            e.printStackTrace();
        }
    }
    
    public void SendMailWP(Cargador objCargador, String linkWP) {
        String _template = "<!DOCTYPE html PUBLIC \"-//W3C//DTD XHTML 1.0 Transitional//EN\" \"http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd\">\n<html xmlns=\"http://www.w3.org/1999/xhtml\" xmlns:o=\"urn:schemas-microsoft-com:office:office\">\n\n<head>\n    <meta charset=\"UTF-8\">\n    <meta content=\"width=device-width, initial-scale=1\" name=\"viewport\">\n    <meta name=\"x-apple-disable-message-reformatting\">\n    <meta http-equiv=\"X-UA-Compatible\" content=\"IE=edge\">\n    <meta content=\"telephone=no\" name=\"format-detection\">\n    <title></title>\n    <!--[if (mso 16)]>     <style type=\"text/css\">     a {text-decoration: none;}     </style>     <![endif]-->\n    <!--[if gte mso 9]><style>sup { font-size: 100% !important; }</style><![endif]-->\n    <!--[if gte mso 9]> <xml>     <o:OfficeDocumentSettings>     <o:AllowPNG></o:AllowPNG>     <o:PixelsPerInch>96</o:PixelsPerInch>     </o:OfficeDocumentSettings> </xml> <![endif]-->\n</head>\n\n<body>\n    <div class=\"es-wrapper-color\">\n        <!--[if gte mso 9]>    <v:background xmlns:v=\"urn:schemas-microsoft-com:vml\" fill=\"t\">     <v:fill type=\"tile\" color=\"#f6f6f6\"></v:fill>    </v:background>   <![endif]-->\n        <table class=\"es-wrapper\" width=\"100%\" cellspacing=\"0\" cellpadding=\"0\">\n            <tbody>\n                <tr>\n                    <td class=\"esd-email-paddings\" valign=\"top\">\n                        <table class=\"esd-header-popover es-header\" cellspacing=\"0\" cellpadding=\"0\" align=\"center\">\n                            <tbody>\n                                <tr>\n                                    <td class=\"esd-stripe\" align=\"center\">\n                                        <table class=\"es-header-body\" width=\"600\" cellspacing=\"0\" cellpadding=\"0\" bgcolor=\"#ffffff\" align=\"center\">\n                                            <tbody>\n                                                <tr>\n                                                    <td class=\"es-p20t es-p20r es-p20l esd-structure\" align=\"left\">\n                                                        <table width=\"100%\" cellspacing=\"0\" cellpadding=\"0\">\n                                                            <tbody>\n                                                                <tr>\n                                                                    <td class=\"esd-container-frame\" width=\"560\" align=\"left\">\n                                                                        <table width=\"100%\" cellspacing=\"0\" cellpadding=\"0\">\n                                                                            <tbody>\n                                                                                <tr>\n                                                                                    <td class=\"esd-block-spacer es-p5\" style=\"font-size:0\" align=\"center\">\n                                                                                        <table width=\"100%\" height=\"100%\" cellspacing=\"0\" cellpadding=\"0\" border=\"0\">\n                                                                                            <tbody>\n                                                                                                <tr>\n                                                                                                    <td style=\"border-bottom: 9px solid #1611be; background: rgba(0, 0, 0, 0) none repeat scroll 0% 0%; height: 1px; width: 100%; margin: 0px;\"></td>\n                                                                                                </tr>\n                                                                                            </tbody>\n                                                                                        </table>\n                                                                                    </td>\n                                                                                </tr>\n                                                                                <tr>\n                                                                                    <td class=\"esd-block-image\" style=\"font-size: 0px;\" align=\"center\"><a target=\"_blank\"><img class=\"adapt-img\" src=\"https://www.colemed.com/mailmasivo/bannerMDAhmtl.png\" alt style=\"display: block;\" width=\"560\"></a></td>\n                                                                                </tr>\n                                                                                <tr>\n                                                                                    <td class=\"esd-block-spacer es-p5\" style=\"font-size:0\" align=\"center\">\n                                                                                        <table width=\"100%\" height=\"100%\" cellspacing=\"0\" cellpadding=\"0\" border=\"0\">\n                                                                                            <tbody>\n                                                                                                <tr>\n                                                                                                    <td style=\"border-bottom: 9px solid #1611be; background: rgba(0, 0, 0, 0) none repeat scroll 0% 0%; height: 1px; width: 100%; margin: 0px;\"></td>\n                                                                                                </tr>\n                                                                                            </tbody>\n                                                                                        </table>\n                                                                                    </td>\n                                                                                </tr>\n                                                                                <tr>\n                                                                                    <td class=\"esd-block-text\" align=\"left\">\n                                                                                        <p style=\"font-size: 22px; text-align: left;\">Para ingresar al grupo de WhatsApp de Colegio M\u00e9dico haga click <a target=\"_blank\" style=\"font-size: 22px; text-align: left;\" href=\"" + linkWP + "\">Aqu\u00ed</a>.</p>\n                                                                                        <p><br><br></p>\n                                                                                    </td>\n                                                                                </tr>\n                                                                                <tr>\n                                                                                    <td class=\"esd-block-image\" style=\"font-size: 0px;\" align=\"center\"><a target=\"_blank\"><img class=\"adapt-img\" src=\"https://www.colemed.com/mailmasivo/bloque/whatsapp.png\" alt style=\"display: block;\" width=\"256\"></a></td>\n                                                                                </tr>\n                                                                                <tr>\n                                                                                    <td class=\"esd-block-text\" align=\"left\">\n                                                                                        <p><br>Recuerde que si no desea mostrar sus datos personales a los integrantes de los grupos en los que participa en WhatsApp, debe ir a <strong>Ajustes &gt;&gt; Cuenta &gt;&gt; Privacidad &gt;&gt; Info.</strong> y seleccionar con quien desea compartir su informaci\u00f3n.<br></p>\n                                                                                    </td>\n                                                                                </tr>\n                                                                            </tbody>\n                                                                        </table>\n                                                                    </td>\n                                                                </tr>\n                                                            </tbody>\n                                                        </table>\n                                                    </td>\n                                                </tr>\n                                            </tbody>\n                                        </table>\n                                    </td>\n                                </tr>\n                            </tbody>\n                        </table>\n                        <table class=\"es-content esd-footer-popover\" cellspacing=\"0\" cellpadding=\"0\" align=\"center\">\n                            <tbody>\n                                <tr>\n                                    <td class=\"esd-stripe\" align=\"center\">\n                                        <table class=\"es-content-body\" style=\"background-color: #ffffff;\" width=\"600\" cellspacing=\"0\" cellpadding=\"0\" bgcolor=\"#ffffff\" align=\"center\">\n                                            <tbody>\n                                                <tr>\n                                                    <td class=\"esd-structure es-p20t es-p20r es-p20l\" align=\"left\">\n                                                        <table width=\"100%\" cellspacing=\"0\" cellpadding=\"0\">\n                                                            <tbody>\n                                                                <tr>\n                                                                    <td class=\"es-m-p0r es-m-p20b esd-container-frame\" width=\"560\" valign=\"top\" align=\"center\">\n                                                                        <table width=\"100%\" cellspacing=\"0\" cellpadding=\"0\">\n                                                                            <tbody>\n                                                                                <tr>\n                                                                                    <td class=\"esd-block-spacer es-p5\" style=\"font-size:0\" align=\"center\">\n                                                                                        <table width=\"100%\" height=\"100%\" cellspacing=\"0\" cellpadding=\"0\" border=\"0\">\n                                                                                            <tbody>\n                                                                                                <tr>\n                                                                                                    <td style=\"border-bottom: 9px solid #1611be; background: rgba(0, 0, 0, 0) none repeat scroll 0% 0%; height: 1px; width: 100%; margin: 0px;\"></td>\n                                                                                                </tr>\n                                                                                            </tbody>\n                                                                                        </table>\n                                                                                    </td>\n                                                                                </tr>\n                                                                                <tr>\n                                                                                    <td class=\"esd-block-text\" align=\"center\">\n                                                                                        <p style=\"font-size: 18px; color: #a9a9a9;\"><em>Por favor, no responder este correo.</em></p>\n                                                                                    </td>\n                                                                                </tr>\n                                                                                <tr>\n                                                                                    <td class=\"esd-block-spacer es-p5\" style=\"font-size:0\" align=\"center\">\n                                                                                        <table width=\"100%\" height=\"100%\" cellspacing=\"0\" cellpadding=\"0\" border=\"0\">\n                                                                                            <tbody>\n                                                                                                <tr>\n                                                                                                    <td style=\"border-bottom: 9px solid #1611be; background: rgba(0, 0, 0, 0) none repeat scroll 0% 0%; height: 1px; width: 100%; margin: 0px;\"></td>\n                                                                                                </tr>\n                                                                                            </tbody>\n                                                                                        </table>\n                                                                                    </td>\n                                                                                </tr>\n                                                                            </tbody>\n                                                                        </table>\n                                                                    </td>\n                                                                </tr>\n                                                            </tbody>\n                                                        </table>\n                                                    </td>\n                                                </tr>\n                                            </tbody>\n                                        </table>\n                                    </td>\n                                </tr>\n                            </tbody>\n                        </table>\n                    </td>\n                </tr>\n            </tbody>\n        </table>\n    </div>\n</body>\n\n</html>";
        String _mensaje = "";
        try {
            Properties propiedad = new Properties();
            propiedad.setProperty("mail.smtp.host", "mail.colemed.com");
            propiedad.setProperty("mail.smtp.starttls.enable", "false");
            propiedad.setProperty("mail.smtp.port", "587");
            propiedad.setProperty("mail.smtp.user", "whatsapp@colemed.com");
            propiedad.setProperty("mail.smtp.auth", "true");
            Session session = Session.getDefaultInstance(propiedad, (Authenticator)null);
            session.setDebug(true);
            BodyPart adjunto = (BodyPart)new MimeBodyPart();
            adjunto.setDataHandler(new DataHandler((DataSource)new FileDataSource(new JFileChooser().getSelectedFile())));
            MimeMessage message = new MimeMessage(session);
            message.setFrom((Address)new InternetAddress("whatsapp@colemed.com"));
            message.addRecipient(Message.RecipientType.TO, (Address)new InternetAddress(objCargador.mail));
            message.setSubject("Invitación al Grupo de WhatsApp CMT");
            MimeMultipart content = new MimeMultipart();
            MimeBodyPart textPart = new MimeBodyPart();
            textPart.setText(_template.replaceAll("#MENSAJE#", _mensaje), "utf-8", "html");
            content.addBodyPart((BodyPart)textPart);
            message.setContent((Multipart)content);
            Transport t = session.getTransport("smtp");
            t.connect("whatsapp@colemed.com", "Lamadrid51");
            t.sendMessage((Message)message, message.getAllRecipients());
            t.close();
            JOptionPane.showMessageDialog(null, "Invitación enviada.");
        }
        catch (Exception e) {
            JOptionPane.showMessageDialog(null, "La invitación no pudo ser enviada.");
            e.printStackTrace();
        }
    }
}
